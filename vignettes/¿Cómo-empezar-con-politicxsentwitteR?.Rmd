---
title: "¿Cómo-empezar-con-politicxsentwitteR?"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Presentation}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
options(scipen = 9999)
options(rmarkdown.html_vignette.check_title = FALSE)
```


### Instalación:

1. Instalamos el paquete y otras librerias necesarias:
```{r, message = FALSE}
library(tidyverse)
library(devtools)
#install_github("guadag12/politicxsentwitteR", force=T)
library(politicxsentwitteR)
```

### Descargá la data de politicxs:

2. Lista de usuarios que contiene [Politicxs en twitter]()

Podemos ver la lista que tenemos de funcionarios con *politicxs_data*:
```{r, message = FALSE}
head(politicxs_data)
```

### Timeline de usuarios:

3. a. Podemos descargar sobre un usuario determinado con la función *get_timeline_data*
```{r, eval = FALSE}
timeline_mev <- get_timeline_data("mariuvidal")
```


```{r, include= FALSE}
timeline_mev <- readRDS(file = "/Users/guadalupegonzalez/Documents/GitHub/politicxsentwitteR/data_v/timeline_mev.rds")
```

```{r}
head(timeline_mev,2)
```

b. E incluso saber cuándo fue que más twitteó:
```{r, message = FALSE}
library(hrbrthemes)

timeline_mev %>%
         group_by(date=as.Date(created_at)) %>%
         summarise(value = n()) %>%
         ggplot( aes(x=date, y=value)) +
           geom_area(fill="#dbb012", alpha=0.5) +
           geom_line(color="#dbb012") +
           ggtitle("Tweets emitidos por @mariuvidal") +
           theme_ipsum()

```
c. Podemos hacerlo comparando la cantidad de tweets de más de un usuario:
```{r, eval=FALSE}
timeline_af_mm <- get_timeline_data(screen.name = c("alferdez", "mauriciomacri"))
```

```{r,  include= FALSE}
timeline_af_mm <- readRDS(file = "/Users/guadalupegonzalez/Documents/GitHub/politicxsentwitteR/data_v/timeline_af_mm.rds")
```

```{r, message = FALSE}
head(timeline_af_mm, 2)
```

d. Además, podemos graficar en qué periodos de tiempos más twittearon ambos:
```{r, message = FALSE}
timeline_af_mm %>%
        group_by(date=as.Date(created_at), screen_name) %>%
        summarise(value = n()) %>%
        ggplot( aes(x=date, y=value)) +
          geom_area(aes(fill = screen_name), alpha=0.5) +
          geom_line(aes(color = screen_name)) +
          ggtitle("Tweets emitidos por @mauriciomacri y @alferdez") +
          theme_ipsum()
```



### Friends & Followers: 

4.a. Podemos ver cuántos amigos tiene cada uno con la función *get_friends_followers*:
```{r, eval=FALSE}
foll_friends_mv_hl <- get_friends_followers(screen.name = c("mariuvidal", "horaciorlarreta"))
```

```{r,  include= FALSE}
foll_friends_mv_hl <- readRDS(file = "/Users/guadalupegonzalez/Documents/GitHub/politicxsentwitteR/data_v/foll_friends_mv_hl.rds")
```


```{r}
foll_friends_mv_hl$date <- as.Date(foll_friends_mv_hl$date)
head(foll_friends_mv_hl,2)
```


b. E incluso podemos graficarlo:

```{r, message = FALSE}
library(sknifedatar)
library(tidyr)

plot_foll_friends <- foll_friends_mv_hl %>% 
  gather(key = "tipo_interaccion", value = "value", c("friends_count", "followers_count")) %>%
  select(screen_name, date, tipo_interaccion, value) %>%
  nest(nested_column=-tipo_interaccion) %>%
  mutate(
    .plot = purrr::map(nested_column, ~
                       ggplot(.x, aes(x=date, y=as.numeric(value))) + geom_line(aes(color=screen_name))
    )
  )
```

```{r, echo=FALSE}
xaringanExtra::use_panelset()
```

`r automagic_tabs(input_data = plot_foll_friends, panel_name = "tipo_interaccion", .output = ".plot",
                  .layout = "l-page", fig.heigth=1, fig.width=10, echo = F)`


### Redes 

5.a. Podemos obtener la data de redes (para un periodo de tiempo y que se actualiza de manera mensual):
```{r, eval=FALSE}
others_network <- get_network_data(category = "others") 
```

```{r,  include= FALSE}
others_network <- readRDS(file = "/Users/guadalupegonzalez/Documents/GitHub/politicxsentwitteR/data_v/others_network.rds")
```


5.b. También podemos hacer una nube con la info obtenida: 
```{r}
library(igraph)
library(networkD3)
others_network <- others_network %>%
                           left_join(politicxs_data) %>%
                           select(screen_name_from = screen_name, retweet_user_id, value) %>%
                           left_join(politicxs_data, by = c("retweet_user_id"= "user_id")) %>%
                           select(from=screen_name_from, to = screen_name, value) %>%
                           drop_na()

p <- simpleNetwork(others_network, height="100px", width="100px")
p
```



